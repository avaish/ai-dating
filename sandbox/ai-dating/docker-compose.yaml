version: '3.8'

services:
  nginx:
    container_name: proxy-ai-dating-app
    build:
      context: ./frontend/
      dockerfile: Dockerfile
    image: proxy-ai-dating-app
    ports:
      - '80:80'
    volumes:
      - ./frontend/:/app/
    networks:
      - ai-dating-network
    depends_on:
      - ai-dating
  ai-dating:
    container_name: ai-dating
    build:
      context: ./backend/
      dockerfile: Dockerfile
    image: ai-dating
    ports:
      - "8001:5000"
    volumes:
      - ./backend/:/app/
    networks:
      ai-dating-network:
        aliases:
          - ai-dating-app
    env_file:
    - path: ./default.env
      required: true
    - path: ./.env.local
      required: false
  db:
    image: postgres:13
    container_name: db
    volumes:
      - dbdata:/var/lib/postgresql/data/
    networks:
      ai-dating-network:
    environment:
      - POSTGRES_USER=ai_dating
      - POSTGRES_PASSWORD=ai_dating
      - POSTGRES_DB=ai_dating_dev
    ports:
      - "5432:5432"
    expose:
      - 5432

volumes:
  dbdata:

networks:
  ai-dating-network:
